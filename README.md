# Система распознавания жестов

Проект представляет собой комплексное решение для распознавания жестов с использованием нескольких подходов машинного обучения и компьютерного зрения.

## Описание проекта

Система способна распознавать 5 типов жестов:
1. Большой палец вверх (thumbs_up)
2. Ладонь (palm)
3. Кулак (fist)
4. Указательный палец (pointing)
5. Знак победы (victory)

Распознавание осуществляется в реальном времени с использованием веб-камеры или на загруженном видео.

## Структура проекта

```
├── app.py                     # Основное Streamlit-приложение для демонстрации
├── data_collector.py          # Скрипт для сбора данных с веб-камеры
├── model_training.py          # Скрипт для обучения моделей Random Forest и CNN на PyTorch
├── third_approach_model.py    # Скрипт для обучения LSTM модели на PyTorch
├── requirements.txt           # Зависимости проекта
├── models/                    # Каталог для хранения обученных моделей
│   ├── random_forest_model.pkl  # Модель Random Forest
│   ├── cnn_model.pth          # Модель CNN
│   ├── lstm_model.pth         # Модель LSTM
│   └── class_info.pkl         # Информация о классах
├── training_results/          # Каталог для хранения результатов обучения
│   ├── combined_results.csv   # Сводная таблица с результатами всех моделей
│   ├── results_comparison.csv # Сравнение результатов Random Forest и CNN
│   ├── lstm_results.csv       # Результаты LSTM
│   ├── results_comparison.png # Графики сравнения результатов RF и CNN
│   └── lstm_training_results.png # Графики обучения LSTM
├── gesture_data/              # Каталог для хранения изображений жестов
│   ├── thumbs_up/
│   ├── palm/
│   ├── fist/
│   ├── pointing/
│   └── victory/
└── gesture_videos/            # Каталог для хранения видео с жестами (для LSTM)
    ├── thumbs_up/
    ├── palm/
    ├── fist/
    ├── pointing/
    └── victory/
```

## Реализованные подходы к распознаванию

В проекте реализованы и сравниваются три подхода к распознаванию жестов:

1. **Random Forest на основе признаков MediaPipe**:
   - Использует координаты и расстояния между ключевыми точками руки.
   - Быстрый и достаточно точный подход.

2. **Сверточная нейронная сеть (CNN) на PyTorch**:
   - Работает с изображениями руки, извлекая визуальные паттерны.
   - Обеспечивает высокую точность, но требует больше вычислительных ресурсов.

3. **LSTM на временных последовательностях (PyTorch)**:
   - Использует изменение положения руки во времени.
   - Эффективен для динамических жестов, учитывает временную составляющую.

## Установка и запуск

### Предварительные требования

- Python 3.8 или выше
- Установленные библиотеки из файла requirements.txt

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Сбор данных

Для сбора собственного набора данных запустите:

```bash
python data_collector.py
```

Для сбора конкретного жеста используйте:

```bash
python data_collector.py --gesture 0 --samples 200
```

Где `gesture` - индекс жеста (0-4), а `samples` - количество образцов.

### Обучение моделей

Для обучения моделей Random Forest и CNN:

```bash
python model_training.py
```

Для обучения LSTM модели:

```bash
python third_approach_model.py
```

### Запуск приложения

```bash
streamlit run app.py
```

## Результаты сравнения моделей

| Метрика | Random Forest | CNN | LSTM |
|---------|---------------|-----|------|
| Точность | 0.9358 | 0.8930 | 0.1333 |
| Время обучения (с) | 0.31 | 72.57 | 1.06 |
| Время инференса (мс) | 0.09 | 3.98 | 0.12 |

## Сравнение подходов

| Подход | Точность | Скорость работы | Преимущества | Недостатки |
|--------|----------|----------------|--------------|------------|
| Random Forest | Высокая (93.58%) | Очень быстрый | Низкие требования к вычислениям, быстрое инференсирование | Меньшая точность на сложных жестах |
| CNN (PyTorch) | Высокая (89.30%) | Средняя | Высокая точность, устойчивость к вариациям | Более высокие требования к вычислениям |
| LSTM (PyTorch) | Низкая (13.33%) | Средняя | Учитывает временную динамику, потенциально лучше для сложных динамических жестов | Требует видеопоследовательности, сложности в обучении |

## Метрики и оценка качества

Для оценки качества моделей используются следующие метрики:
- Точность (Accuracy)
- Время обучения
- Время инференса (предсказания)
- Матрица ошибок (Confusion Matrix)

Результаты визуализируются в виде графиков и экспортируются в файлы CSV.

## Особенности реализации на PyTorch

Нейросетевые модели (CNN и LSTM) реализованы с использованием фреймворка PyTorch:

- Модульная архитектура с использованием `torch.nn.Module`
- Оптимизация с помощью Adam
- Использование функции потерь CrossEntropyLoss
- Поддержка GPU ускорения (если доступно)
- Сохранение моделей в формате `.pth`

